<?php
$mediaId = isset($mediaId) ? $mediaId : null;
$mediaTitle = isset($mediaTitle) ? $mediaTitle : '';
$framePercent = isset($framePercent) ? (int)$framePercent : 10;

// Add our script and ensure it runs after Omeka's scripts
$this->headScript()->appendFile($this->assetUrl('js/video-thumbnail-block-admin.js', 'VideoThumbnail'));
?>

<div class="video-thumbnail-form-container">
    <div class="field">
        <div class="field-meta">
            <label><?= $this->translate('Video Media') ?></label>
            <div class="field-description"><?= $this->translate('Select a video to display its thumbnail') ?></div>
        </div>
        <div class="inputs">
            <input type="hidden" name="o:block[__blockIndex__][o:data][media_id]" value="<?= $this->escapeHtml($mediaId) ?>" class="media-id">
            
            <div class="value">
                <span class="selected-media">
                    <?= $mediaTitle ? $this->escapeHtml($mediaTitle) : $this->translate('No media selected') ?>
                </span>
            </div>
            
            <div class="actions">
                <button type="button" class="select-media button"
                        data-sidebar-content-url="<?= $this->escapeHtml($this->url('admin/default', ['controller' => 'media', 'action' => 'sidebar-select'])) ?>">
                    <?= $this->translate('Select Video') ?>
                </button>
                
                <?php if ($mediaId): ?>
                <button type="button" class="remove-media button"><?= $this->translate('Clear') ?></button>
                <?php endif; ?>
            </div>
        </div>
    </div>
    
    <div class="field">
        <div class="field-meta">
            <label><?= $this->translate('Thumbnail Frame Position (%)') ?></label>
            <div class="field-description"><?= $this->translate('Position in the video to use for the thumbnail (0-100%)') ?></div>
        </div>
        <div class="inputs">
            <input type="number" 
                   name="o:block[__blockIndex__][o:data][frame_percent]" 
                   value="<?= $this->escapeHtml($framePercent) ?>" 
                   min="0" 
                   max="100" 
                   class="frame-percent">
        </div>
    </div>
</div>